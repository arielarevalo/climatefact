% Diagram 3: Knowledge Base Construction Pipeline
\begin{tikzpicture}[node distance=1.1cm]
  % Linear chain
  \node[io] (pdf) {IPCC AR6 PDF};
  \node[process, below=of pdf] (extract) {PDF Extraction};
  \node[process, below=of extract] (coref) {Coreference Resolution};
  \node[process, below=of coref] (sent) {Sentence Segmentation};

  % Fork into two branches
  \node[process, below left=1.1cm and 1.0cm of sent] (vec)
    {Semantic Vectorization};
  \node[process, below right=1.1cm and 1.0cm of sent] (cidx)
    {Concept Index Construction};

  % Data stores — larger for readability
  \node[datastore, below=0.9cm of vec] (passages)
    {\texttt{passages.jsonl}};
  \node[datastore, below=0.9cm of cidx] (index)
    {\texttt{concept\_index.json}};

  % Arrows — linear chain
  \draw[arrow] (pdf) -- (extract);
  \draw[arrow] (extract) -- (coref);
  \draw[arrow] (coref) -- (sent);

  % Fork arrows
  \draw[arrow] (sent) -- (vec);
  \draw[arrow] (sent) -- (cidx);

  % To data stores
  \draw[arrow] (vec) -- (passages);
  \draw[arrow] (cidx) -- (index);

  % Annotations
  \node[annot, right=0.3cm of extract] {MinerU};
  \node[annot, right=0.3cm of coref] {AllenNLP / SpanBERT-large};
  \node[annot, left=0.15cm of vec, anchor=east] {text-embedding-3-small};
  \node[annot, right=0.15cm of cidx, anchor=west] {regex + spaCy + NLTK};
\end{tikzpicture}
